{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "Learning Support: Check Understanding",
      "type": "shell",
      "command": "python",
      "args": [
        ".learning_support/understanding_checker.py",
        "${input:concept_name}"
      ],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      },
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": []
    },
    {
      "label": "Learning Support: Generate Learning Path",
      "type": "shell",
      "command": "python",
      "args": [
        ".learning_support/learning_path_generator.py",
        "${input:target_concept}"
      ],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      },
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": []
    },
    {
      "label": "Learning Support: Record TDD Practice",
      "type": "shell",
      "command": "python",
      "args": [
        ".learning_support/tdd_tracker.py",
        "${input:tdd_phase}",
        "${input:concept_name}"
      ],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      },
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": []
    },
    {
      "label": "Learning Support: Check Review Schedule",
      "type": "shell",
      "command": "python",
      "args": [".learning_support/review_scheduler.py", "--check"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      },
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": []
    },
    {
      "label": "TDD: Run Tests (Red Phase)",
      "type": "shell",
      "command": "python",
      "args": ["-m", "pytest", "${input:test_file}", "-v"],
      "group": {
        "kind": "test",
        "isDefault": true
      },
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      },
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": ["$python"]
    },
    {
      "label": "Towncrier: Create Feature Fragment",
      "type": "shell",
      "command": "python",
      "args": [
        ".learning_support/changelog_helper.py",
        "create",
        "feature",
        "${input:change_description}"
      ],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      },
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": []
    },
    {
      "label": "Towncrier: Create Bugfix Fragment",
      "type": "shell",
      "command": "python",
      "args": [
        ".learning_support/changelog_helper.py",
        "create",
        "bugfix",
        "${input:change_description}"
      ],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      },
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": []
    },
    {
      "label": "Towncrier: Generate Changelog",
      "type": "shell",
      "command": "towncrier",
      "args": ["--draft"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      },
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": []
    },
    {
      "label": "Learning Support: Full Check",
      "type": "shell",
      "command": "python",
      "args": [".learning_support/full_learning_check.py"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      },
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": []
    },
    {
      "label": "Install Dependencies",
      "type": "shell",
      "command": "uv",
      "args": ["install", "--dev"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      }
    },
    {
      "label": "Run Tests",
      "type": "shell",
      "command": "uv",
      "args": ["run", "pytest"],
      "group": {
        "kind": "test",
        "isDefault": true
      },
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      }
    },
    {
      "label": "Format Code",
      "type": "shell",
      "command": "uv",
      "args": ["run", "black", "."],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "silent",
        "focus": false,
        "panel": "shared"
      }
    },
    {
      "label": "Sort Imports",
      "type": "shell",
      "command": "uv",
      "args": ["run", "isort", "."],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "silent",
        "focus": false,
        "panel": "shared"
      }
    },
    {
      "label": "Lint Code",
      "type": "shell",
      "command": "uv",
      "args": ["run", "flake8"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      }
    },
    {
      "label": "Type Check",
      "type": "shell",
      "command": "uv",
      "args": ["run", "mypy", "src/"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      }
    },
    {
      "label": "Security Scan",
      "type": "shell",
      "command": "uv",
      "args": ["run", "bandit", "-r", "src/"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      }
    },
    {
      "label": "All Checks",
      "dependsOrder": "sequence",
      "dependsOn": [
        "Format Code",
        "Sort Imports",
        "Lint Code",
        "Type Check",
        "Security Scan",
        "Run Tests"
      ],
      "group": "build"
    },
    {
      "label": "Start Dev Server",
      "type": "shell",
      "command": "uv",
      "args": [
        "run",
        "uvicorn",
        "household_mcp.server:app",
        "--reload",
        "--host",
        "0.0.0.0",
        "--port",
        "8000"
      ],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "new"
      },
      "isBackground": true,
      "problemMatcher": []
    },
    {
      "label": "Start HTTP API Server",
      "type": "shell",
      "command": "uv",
      "args": [
        "run",
        "python",
        "-m",
        "uvicorn",
        "household_mcp.web.http_server:create_http_app",
        "--factory",
        "--reload",
        "--host",
        "0.0.0.0",
        "--port",
        "8000"
      ],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "dedicated",
        "showReuseMessage": false
      },
      "isBackground": true,
      "problemMatcher": {
        "pattern": {
          "regexp": "^.*$",
          "file": 1,
          "location": 2,
          "message": 3
        },
        "background": {
          "activeOnStart": true,
          "beginsPattern": "^.*Uvicorn running.*$",
          "endsPattern": "^.*Application startup complete.*$"
        }
      }
    },
    {
      "label": "Start Webapp HTTP Server",
      "type": "shell",
      "command": "python3",
      "args": ["-m", "http.server", "8080"],
      "options": {
        "cwd": "${workspaceFolder}/webapp"
      },
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "dedicated",
        "showReuseMessage": false
      },
      "isBackground": true,
      "problemMatcher": {
        "pattern": {
          "regexp": "^.*$",
          "file": 1,
          "location": 2,
          "message": 3
        },
        "background": {
          "activeOnStart": true,
          "beginsPattern": "^.*Serving HTTP.*$",
          "endsPattern": "^.*Serving HTTP on.*$"
        }
      }
    },
    {
      "label": "Start Full Webapp Stack",
      "dependsOrder": "parallel",
      "dependsOn": ["Start HTTP API Server", "Start Webapp HTTP Server"],
      "group": {
        "kind": "build",
        "isDefault": true
      },
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "dedicated"
      },
      "problemMatcher": []
    }
  ],
  "inputs": [
    {
      "id": "concept_name",
      "description": "学習する概念の名前を入力してください",
      "default": "CSVリーダー",
      "type": "promptString"
    },
    {
      "id": "target_concept",
      "description": "目標とする概念を入力してください",
      "default": "SQLiteの複雑なJOINクエリ",
      "type": "promptString"
    },
    {
      "id": "tdd_phase",
      "description": "TDDのフェーズを選択してください",
      "default": "red",
      "type": "pickString",
      "options": ["red", "green", "refactor"]
    },
    {
      "id": "test_file",
      "description": "テストファイルのパスを入力してください",
      "default": "tests/",
      "type": "promptString"
    },
    {
      "id": "change_description",
      "description": "変更の説明を入力してください",
      "default": "新機能を追加",
      "type": "promptString"
    }
  ]
}
